<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Blockstamp</title>

    <!-- Bootstrap -->
    <link href="/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<!-- import bootstrap cdn-->
<link rel="stylesheet" href=
"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity=
"sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
        crossorigin="anonymous">
    <!-- import jquery cdn -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity=
"sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous">
    </script>
    <!-- import popper.js cdn -->
    <script src=
"https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity=
"sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous">
    </script>
    <!-- import javascript cdn -->
    <script src=
"https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity=
"sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous">
    </script>
    <style>
      body{
        font-family: 'Syne', sans-serif; 
      }
      main {
        /* margin-top: 40px; */
      }

      #content {
        display: none;
      }

      form {
        width: 350px;
        margin-bottom: 10px;
      }

      ul {
        margin-bottom: 0px;
      }

      #completedTaskList .content {
        color: grey;
        text-decoration: line-through;
      }
      #the-canvas {
      outline: white 2px dashed;
      border-radius: 15px;
      }
      .container {
  --sidebar-width: 20px;
}

.main {
  display: flex;
}

.sidebar {
  position: fixed;
  overflow-y: auto;
  height: 100%;
  width: var(--sidebar-width);
  z-index: 1;
  background-color: #e3f2fd;
  padding-left: 15px;
  padding-right: 50px;
  padding-top: 10px;
  margin-top: 40px;
}

.content {
  margin-left: var(--sidebar-width);
  flex-grow: 1;
}
.link{
  background-color: pink;
}

    </style>
  </head>
  <body>
      <!-- top navbar -->
      <!-- TOP -->
      <nav class="navbar fixed-top flex-md-nowrap p-0 shadow" style="background-color: #e3f2fd;">
        <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="" target="_blank" style="">Blockstamp</a>
        <ul class="navbar-nav px-3">
          <div style="display: flex; align-items: center;">
            <li class="nav-item text-nowrap d-none d-sm-none d-sm-block">
              <small><a class="nav-link" href="#"><span id="account"></span></a></small>
            </li>
              <li>
                <img src="<%= picture %>" alt="" style="border-radius: 15px; margin-left: 10px;" height="25px" width="25px">
              </li> 
          </div>       
        </ul>
      </nav>
      <!-- BOTTOM -->
      <!-- <div class="modern"> -->
      <!-- <div class="container-fluid h-100"> -->
        <main class="main">
          <div class="sidebar">
            <!-- <h4>Sidebar</h4> -->
                  <!-- Navigation links in sidebar-->
                  <!-- <div class="link"> -->
                    <a href="uploads">Uploads</a>
                  <!-- </div> -->
                  <br/>
                  <br/>
                  <a href="settings">Settings</a>
                  <br/>
                  <br/>
                  <a href="#">Link 3</a>
                  <br/>
                  <br/>
                  <!-- <div class="overlay"> -->
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-files" viewBox="0 0 16 16">
                    <path d="M13 0H6a2 2 0 0 0-2 2 2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2 2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 13V4a2 2 0 0 0-2-2H5a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1zM3 4a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4z"/>
                  </svg>
                <!-- </div> -->
                  <!-- <a href="#">Link 4</a> -->
                  <br/>
                  <br/>
                  <a href="/" onclick="">Sign out</a>
          </div>
          <!-- <div class="content">
            <ul>
              <li>content</li>
              ... 
            </ul>
          </div> -->
        </main>
      <!-- </div> -->

      <!-- This container contains the sidebar
              and main content of the page -->
      <!-- h-100 takes the full height of the body-->
      <div class="container-fluid h-100">
          <div class="row h-100">
              <!-- <div class="col-2" id="green">
                
              </div> -->
              <!--Contains the main content
                      of the webpage-->
                        <div class="" style="margin-left: 125px;">
                          <main role="main" class="col-lg-12 d-flex justify-content-center">
                            <div id="loader" class="text-center">
                              <p class="text-center">Loading...</p>
                            </div>
                  
                            <div id="content" style="width: inherit; margin-top: 40px;">
                  
                            <h1>Dashboard</h1>
                            
                              <!-- <h3>Welcome, <%= displayName %></h3>
                            <p id="senderEmail"><%= email %></p> -->
                            <form action="/logout" method="POST">
                              <button type="submit" class="btn btn-danger"><span class="fa fa-google"></span> SignOut</button>
                            </form>
                              <div style="color: black; background-color: #e3f2fd; padding: 20px; border-radius: 10px;">
                                <form onSubmit="App.createTask();" method="POST" action="/documentUpload" enctype="multipart/form-data" >
                                  <h3>Upload Documents</h3>
                                  <div>
                                    <label for="myfile">Select a file:</label>
                                    <input type="file" id="myfile" name="image" required onchange="previewFile()">
                                    <br><br>
                                    <canvas id="the-canvas"></canvas>
                                    <!-- <img src="" height="200" alt="Image preview..."> -->
                                    <input type="hidden" value="">
                                    <p id="hashCode" name="hashCode" value="hashCode"></p>
                                    <p id="senderEmail2" style="display: none;"><%= email %></p>
                                  </div>
                                  
                                  <!-- <br> -->
                                  <label for="newTask">Enter Recipient</label>
                                  <input id="newTask" type="text" class="form-control" placeholder="Email" required name="recipient">
                                  <!-- hidden is log equivalent -->
                                  <input type="hidden" name="hashc0d3" id="hashc0d3" value="hashc0d3">
                                  <input type="hidden" name="senderE" id="senderE" value="senderE">
                                  <br>
                                  <!-- <input id="newTaskAddress" type="text" class="form-control" placeholder="Email Address" required> -->
                                  <button type="submit" class="btn btn-primary">Upload to Blockchain</button>
                                </form>
                              </div>
                              <h3>Inbox</h3>
                              <ul id="taskList" class="list-unstyled">
                                
                                <form class="taskTemplate" method="POST" action="/details">
                                <div class="taskTemplate" class="checkbox" style="display: none">
                                  <div style="border: 2px solid lightgrey; border-radius: 15px;">
                                    <input type="checkbox" class="xyz"/>
                                    <a class="content" type="submit" href="details.ejs" onclick="myFunction()" id="clickedContent"></a>
                                    <p class="content2"></p>
                                    <p class="hashc0d3"></p>
                                  </div>
                                    
                                  <!-- <button type="submit">button</button> -->
                                  
                                </div>
                                
                                <input type="hidden" name="hid2" value="hid3" id="hid">
                  
                                
                                <input type="hidden" name="jacob" value="jacob">
                  
                              </form>
                  
                              </ul>
                              <ul id="completedTaskList" class="list-unstyled">
                              </ul>
                            </div>
                          </main>
                        </div>
                      </div>
                  
                      <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
                      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
                      <!-- Include all compiled plugins (below), or include individual files as needed -->
                      <!-- <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script> -->
                      <!-- <script src ="../node_modules/web3/dist/web3.js"></script> -->
                      <!-- <script src="../node_modules/truffle-contract/dist/truffle-contract.js"></script>  -->
                      <script src="bootstrap/dist/js/bootstrap.min.js"></script>
                      <script src ="web3.js"></script>
                      <script src="truffle-contract.js"></script> 
                      <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
                      <!-- for pdf render -->
                      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.2.2/pdf.min.js"></script>
                      <!-- 
                      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.0-beta1/js/bootstrap.min.js"></script> -->
                      <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.4/web3.min.js"></script> -->
                      <!-- <script src="https://www.jsdelivr.com/package/npm/truffle-contract"></script> -->
                      <script src="./app.js"></script>
                      <!-- <script>
                        document.getElementById("hid").value = document.getElementsByClassName("content").innerHTML;
                  
                    </script> -->
                  
                  
                    <script>
                      
                      $("#myfile").change(
                        function(){
                          var reader = new FileReader();
                  
                          reader.addEventListener(
                            'load',
                            function(){
                              var wordArray = CryptoJS.lib.WordArray.create(this.result);
                              $("#hashCode").text(CryptoJS.MD5(wordArray));
                              var inputHidden = document.getElementById("hashc0d3");
                              var hashValue = document.getElementById("hashCode").innerHTML;
                              inputHidden.setAttribute('value', hashValue);
                  
                              var senderEmailAddress = document.getElementById("senderE");
                              var setEmail = document.getElementById("senderEmail").innerHTML;
                              senderEmailAddress.setAttribute('value', setEmail);
                  
                  
                            }
                          );
                          reader.readAsArrayBuffer(this.files[0]);
                        }
                      )
                  
                    const PDF_TYPE = "application/pdf";
                  const TXT_TYPE = "text/plain";
                  
                  document.getElementById('myfile').addEventListener('change', handleFileSelect, false);
                  
                  
                  function handleFileSelect(evt) {
                    var files = evt.target.files; // FileList object
                    for (var i = 0, f; f = files[i]; i++) {
                      let fileType = files[i].type;
                      if (fileType === PDF_TYPE) {
                        handlePDFFile(files[i]);
                      } else {
                        console.error(`cannot handle file type: ${fileType}`)
                      }
                    }
                  }
                  
                  
                  function handlePDFFile(file) {
                    var reader = new FileReader();
                  
                    reader.onload = (function(reader) {
                      return function() {
                        var contents = reader.result;
                        var loadingTask = pdfjsLib.getDocument(contents);
                  
                        loadingTask.promise.then(function(pdf) {
                          pdf.getPage(1).then(function(page) {
                            var scale = 0.5;
                            var viewport = page.getViewport({
                              scale: scale,
                            });
                  
                            var canvas = document.getElementById('the-canvas');
                            var context = canvas.getContext('2d');
                            canvas.height = viewport.height;
                            canvas.width = viewport.width;
                  
                            var renderContext = {
                              canvasContext: context,
                              viewport: viewport
                            };
                            page.render(renderContext);
                          });
                        });
                      }
                    })(reader);
                    reader.readAsDataURL(file);
                  }
                      </script>
          </div>
  </body>

    <!-- <nav class="navbar fixed-top flex-md-nowrap p-0 shadow" style="background-color: #e3f2fd;">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="" target="_blank" style="">Blockstamp</a>
      <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap d-none d-sm-none d-sm-block">
          <small><a class="nav-link" href="#"><span id="account"></span></a></small>
        </li>
      </ul>
    </nav> -->

    
</html>
